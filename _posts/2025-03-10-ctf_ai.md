---
title: '[AIÂ≠¶‰π†Á¨îËÆ∞] ÁÆÄÂçïÁöÑAIÁ±ªÈ¢òÁõÆÊ±áÊÄª.'
date: 2025-03-10
permalink: /posts/2025/03/ctf_ai/
excerpt: '‰∏çÁü•ÈÅìÊòØ‰∏çÊòØÂõ†‰∏∫ÂºÄÂßãÂÖ≥Ê≥®Ëµ∑AI, ÊúÄËøëÊÑüËßâAIÁ±ªÈ¢òÂûãË∂äÊù•Ë∂äÂ§ö‰∫Ü...'
tags:
  - ÁΩëÁªúÂÆâÂÖ®
  - CTF
  - AI
---

# ÁõÆÂΩï

- [ÂâçÁΩÆÊ¶ÇÂøµ](#ÂâçÁΩÆÊ¶ÇÂøµ)
  - [cnn](#cnn)
- [apoorvctf2025](#apoorvctf2025)
  - [professor_oak's_electric_misfortune](#professor_oak's_electric_misfortune)
- [ghctf2025](#ghctf2025)
  - [mortis](#mortis)
- [ÂèÇËÄÉÊñáÁåÆ](#ÂèÇËÄÉÊñáÁåÆ)

# ÂâçÁΩÆÊ¶ÇÂøµ

ÂÖ∂ÂÆûÊàëÊú¨ÊÑèÊòØ‰∏çÂ§™ÊÉ≥ËÆ∞ÂΩïAIÁ±ªÈ¢òÁõÆÊù•ÁùÄ, ÊàëÁî®‰∫éËÆ≠ÁªÉAIÁöÑÁîµËÑëË¢´ÂçïÁã¨ÈöîÁ¶ªÂºÄ, ‰∏éÊâìÊØîËµõÁöÑÁîµËÑëÂàÜÂà´ÂçïÁã¨Â≠òÊîæ, ‰ΩÜÊòØÂ≠¶ÁùÄÂÜô‰∏ÄÁÇπ‰∏úË•øÊÄªÊòØÂ•ΩÁöÑ, ‰∏á‰∏Ä‰ª•ÂêéÈúÄË¶Å‰∫ÜÂë¢(Á¨ë).

## cnn

CNNÂèàÁß∞Âç∑ÁßØÁ•ûÁªèÁΩëÁªú, ÁÆóÊòØÂ§ßÈÉ®ÂàÜÂÖ•Èó®AIÁöÑÁ¨¨‰∏ÄËØæ, ÊàëËÆ∞ÂæóÂΩìÊó∂ÊòØÁúã‰∫Ü3b1bÁöÑËßÜÈ¢ë[^3b1b], ‰∫ÜËß£‰∫Ü‰∏™Â§ßÊ¶ÇÂêéËá™Â∑±ÊåâÁÖß‰∏Ä‰∫õÁõ∏ÂÖ≥ÂçöÂÆ¢ËØïÁùÄÁî®numpyÊê≠Âª∫‰∫Ü‰∏Ä‰∏™ÁÆÄÂçïÁöÑÊ®°Âûã[^numpy2cnn], ÂèØÊÉúËØÜÂà´ÊïàÁéáÂ§™‰Ωé, Â∞±‰∏çÂàÜ‰∫´‰∫Ü. 3b1bÁöÑÂèØËßÜÂåñÂÅöÂæóÂæàÂ•Ω, Â∞±‰∏çËøáÂ§öËµòËø∞‰∫Ü.

Â¶ÇÊûúÂç∑ÁßØÁöÑÂèòÈáèÊòØÂ∫èÂàó$$x(n)$$Âíå$$h(n)$$ÔºåÂàôÂç∑ÁßØÁöÑÁªìÊûú‰∏∫:

$$
x(n) * h(n) = \sum{x(i)h(n-i)}
$$

Âç∑ÁßØÁ•ûÁªèÁΩëÁªú‰ΩøÁî®‰∫ÜÂç∑ÁßØËøêÁÆó, Áî®‰∫éÊçïÊçâÂõæÂÉè‰∏≠ÁöÑÂ±ÄÈÉ®ÁâπÂæÅ.

# apoorvctf2025

## professor_oak's_electric_misfortune

ÂÆûÈôÖ‰∏äÂú®ÊØîËµõÂàöÂºÄÂßãÁöÑÊó∂ÂÄôÊàëÂè™Áúã‰∫ÜËøô‰∏ÄÈ¢ò, ÊèèËø∞Â¶Ç‰∏ã:

> üî• Welcome, Pok√©mon Trainer! üî• Hello there! Welcome to the world of Pok√©mon! üåç‚ö° I‚Äôm Professor Oak, the leading Pok√©mon researcher, and I‚Äôve been working on an advanced Pok√©dex upgrade that can automatically classify Pok√©mon types using cutting-edge neural networks. This breakthrough could revolutionize how trainers understand their Pok√©mon! BUT‚Ä¶ there‚Äôs been a slight hiccup in the lab. üò∞ My Pikachu got a little too excited and‚Äîwell, let‚Äôs just say a few crucial data files were shocked into oblivion. ‚ö°üí• Now, the entire system is scrambled, and I need your help to restore order and complete the classifier! Now.. For further details, access the PDF. Heads up!! It's password protected. The password is the name of the pokemon Ash first captured. Good Luck Trainer !!!

### È¢òÁõÆ

```
UG9rZW1vbkNOTgrilJzilIDilIAgSW5pdGlhbCBJbnB1dDogKDI1NiwgMjU2LCA0KQrilIIK4pSc4pSA4pSAIEZlYXR1cmUgRXh0cmFjdGlvbiBMYXllcnMK4pSCICAg4pSc4pSA4pSAIENvbnYyRCAoNC0+MzIpCuKUgiAgIOKUnOKUgOKUgCBCYXRjaE5vcm0yRCAK4pSCICAg4pSc4pSA4pSAIFJlTFUgQWN0aXZhdGlvbgrilIIgICDilJzilIDilIAgTWF4UG9vbDJEKEsgU2l6ZSA9IDMpCuKUgiAgIOKUnOKUgOKUgCBEcm9wb3V0IChwPTAuMjUpCuKUggrilJzilIDilIAgRGVlcGVyIFByb2Nlc3NpbmcK4pSCICAg4pSc4pSA4pSAIENvbnYyRCgzMi0+NjQpCuKUgiAgIOKUnOKUgOKUgCBCYXRjaE5vcm0yRCAoNjQpCuKUgiAgIOKUnOKUgOKUgCBSZUxVIEFjdGl2YXRpb24K4pSCICAg4pSc4pSA4pSAIE1heFBvb2wyRChLIFNpemUgPSAzKQrilIIgICDilJzilIDilIAgRHJvcG91dCAocD0wLjI1KQrilIIK4pSc4pSA4pSAIE1vcmUgRmVhdHVyZSBFeHRyYWN0aW9uCuKUgiAgIOKUnOKUgOKUgCBDb252MkQoNjQtPjEyOCkK4pSCICAg4pSc4pSA4pSAIEJhdGNoTm9ybTJECuKUgiAgIOKUnOKUgOKUgCBSZUxVIEFjdGl2YXRpb24K4pSCICAg4pSc4pSA4pSAIE1heFBvb2wyRChLIFNpemUgPSAzKQrilIIgICDilJzilIDilIAgRHJvcG91dCAocD0wLjI1KQrilIIK4pSc4pSA4pSAIEZ1bGx5IENvbm5lY3RlZCBMYXllcnMK4pSCICAg4pSc4pSA4pSAIEZsYXR0ZW4K4pSCICAg4pSc4pSA4pSAIExpbmVhciAoNTEyIE5ldXJvbnMpCuKUgiAgIOKUnOKUgOKUgCBCYXRjaE5vcm0xRArilIIgICDilJzilIDilIAgRHJvcG91dCAocD0wLjUpCuKUgiAgIOKUnOKUgOKUgCBMaW5lYXIK4pSCICAg4pSc4pSA4pSAIFNvZnRtYXggQWN0aXZhdGlvbgrilIIK4pSU4pSA4pSAIE91dHB1dDogMTggY2xhc3Nlcw==
```

Âè¶Â§ñËøòÊúâ‰∏Ä‰∏™pdfÊñá‰ª∂, ÂØÜÁ†Å‰∏∫`caterpie`, ÁÇπÂºÄÂêéÊúâÂ¶Ç‰∏ãÂÜÖÂÆπ:

>Welcome, Pok√©mon Trainer! 
> 
>Hello there! Welcome to the world of Pok√©mon! 
> 
>I‚Äôm Professor Oak, the leading Pok√©mon researcher, and I‚Äôve been working on an advanced Pok√©dex upgrade that can automatically classify Pok√©mon types using cutting-edge neural networks. This breakthrough could revolutionize how trainers understand their Pok√©mon! 
>
>BUT‚Ä¶ there‚Äôs been a slight hiccup in the lab. 
> 
>My Pikachu got a little too excited and‚Äîwell, let‚Äôs just say a few crucial data files were shocked into oblivion. Now, the entire system is scrambled, and I need your help to restore order and complete the classifier! 
>
>Your mission: Train a CNN model to classify Pok√©mon by type and help me get the Pok√©dex back on track. Are you up for the challenge, Trainer? Let‚Äôs GO! 
>
>Notebook link: https://www.kaggle.com/code/gl3mon/apoorvquestion 
>Dataset link: https://www.kaggle.com/datasets/gl3mon/apoorvctf

### ÂàÜÊûê

ÂæàÈÅóÊÜæÂΩìÊàëÂæóÁü•ÂØÜÁ†ÅÊòØÁªøÊØõËô´ÁöÑÊó∂ÂÄôÂ∑≤ÁªèÊâæ‰∏çÂà∞È°µÈù¢‰∫Ü, ÊâÄ‰ª•Áõ¥Êé•ÁÆÄÂçïÂ§çÁõò‰∏Ä‰∏ã‰ª£Á†ÅÈÉ®ÂàÜ, Ê†∏ÂøÉÊ∫êÁ†ÅÂ¶Ç‰∏ã:

```python
class PokemonCNN(nn.Module):
    def __init__(self):
        super().__init__()

        self.conv1 = nn.Conv2d(4, 32, kernel_size=2)
        self.bn1 = nn.BatchNorm2d(32)
        self.relu = nn.ReLU()
        self.pool = nn.MaxPool2d(kernel_size=3)
        self.drop1 = nn.Dropout(0.25)

        self.conv2 = nn.Conv2d(32, 64, kernel_size=2)
        self.bn2 = nn.BatchNorm2d(64)
        self.relu2 = nn.ReLU()
        self.pool2 = nn.MaxPool2d(kernel_size=3)
        self.drop2 = nn.Dropout(0.25)

        self.conv3 = nn.Conv2d(64, 128, kernel_size=2)
        self.bn3 = nn.BatchNorm2d(128)
        self.relu3 = nn.ReLU()
        self.pool3 = nn.MaxPool2d(kernel_size=3)
        self.drop3 = nn.Dropout(0.25)

        self.flatten = nn.Flatten()
        self.fc1 = nn.Linear(10368, 512)
        self.bn4 = nn.BatchNorm1d(512)
        self.drop4 = nn.Dropout(0.5)
        self.fc2 = nn.Linear(512, 18)
        self.softmax = nn.Softmax()

    def forward(self, x):
        x = self.pool(F.relu(self.bn1(self.conv1(x))))
        x = self.drop1(x)

        x = self.pool(F.relu(self.bn2(self.conv2(x))))
        x = self.drop2(x)

        x = self.pool(F.relu(self.bn3(self.conv3(x))))
        x = self.drop3(x)

        x = self.flatten(x)
        x = self.fc1(x)
        x = self.bn4(x)
        x = self.drop4(x)
        x = self.fc2(x)
        x = self.softmax(x)
        return x
```

emmmm, È¢òÁõÆÂ•ΩÂÉèÊúâÁÇπÂ§çÊùÇ‰∫Ü, ÊçÆÊèèËø∞ÈúÄË¶Å‰ΩøÁî®**GPU T4x2**, ‰∏çËøáÁªìÂêà‰πãÂâçÂ≠¶‰π†deepseekÁöÑ‰∏Ä‰∫õÁªèÈ™å, ÁêÜËÆ∫‰∏äÊòØÂèØ‰ª•Âä†ÂÖ•‰ª•‰∏ã‰ª£Á†Å‰øÆÊîπÁöÑ:

```python
def __init__(self):
        self.device = "cuda" if pt.cuda.is_available() else "cpu"
        print(f"Using device: {self.device}")
```

ÁÑ∂ÂêéÂÖàËøõÁ¨¨‰∏ÄÈ¢ò:

> Question 1: What is the seed of the given code?

Á®ãÂ∫è‰∏≠ÁªôÂá∫‰∫ÜÊèêÁ§∫: `I have not mentioned the seed for security reasons. But I'll let you in on a little secret. It's the pokemon number for charizard.`, ‰ΩÜÊòØÁêÜËß£‰∏ç‰∫Ü, Â§çÁõòÁöÑÊó∂ÂÄôÊàëÁõ¥Êé•‰∏ä‰∫ÜÁàÜÁ†¥:

```python
from EXP.pwn import *

def test(num):
    io("./test")
    print(r())
    s(str(num).encode())
    data = bool(r() == b'> Incorrect answer for question 1.\n')
    close()
    return data

for i in range(10000):
    if test(i):
        continue
    else:
        print(i)
        break

# [*] Stopped process './test' (pid 613)
# 151
```

‰∏çÊòØÂæàÁêÜËß£Âñ∑ÁÅ´Èæô‰∏∫‰ªÄ‰πàÊòØ151ÊÄª‰πã, ‰ΩÜÊòØÊãøÂà∞‰∫ÜÁßçÂ≠êÁºñÂè∑, ÂèØ‰ª•Áõ¥Êé•‰øÆÊîπ‰∏∫`pt.manual_seed(151)`.

> Question 2: What‚Äôs the number of input features of the first linear layer?

Ë∑ë‰∏çÂá∫Êù•, Áõ¥Êé•Êîæ‰ª£Á†Å, ÊúâÊó∂Èó¥ÂÜçÊÖ¢ÊÖ¢ËØ¥.

### EXP

```python
import torch as pt
import torch.nn.functional as F
import torch.nn as nn

pt.manual_seed(151) # I have not mentioned the seed for security reasons. But I'll let you in on a little secret. It's the pokemon number for charizard.

from torch.utils.data import Dataset, DataLoader
from torchvision import datasets
from torchvision.transforms import ToTensor
import matplotlib.pyplot as plt

import os
import pandas as pd
from torchvision.io import read_image

class CTFDataset(Dataset):
    def __init__(self, annotation_file, img_dir, transform = None, target_transform = None):
        self.img_labels = pd.read_csv(annotation_file, index_col=0)
        self.label_mapping = {
            'Bug': 0, 'Dark': 1, 'Dragon': 2, 'Electric': 3, 'Fairy': 4,
            'Fighting': 5, 'Fire': 6, 'Flying': 7, 'Ghost': 8, 'Grass': 9,
            'Ground': 10, 'Ice': 11, 'Normal': 12, 'Poison': 13, 'Psychic': 14,
            'Rock': 15, 'Steel': 16, 'Water': 17
        }
        self.img_labels['class'] = self.img_labels['type'].map(self.label_mapping)
        self.img_dir = img_dir
        self.transform = transform
        self.target_transform = target_transform

    def __len__(self):
        return len(self.img_labels)

    def __getitem__(self, idx):
        img_path = os.path.join(self.img_dir, self.img_labels.iloc[idx]['type'], f'{self.img_labels.iloc[idx]["pkn"]}'+'.png')
        image = None
        try:
            image = read_image(img_path).to(pt.float32)
        except:
            image = pt.zeros(4, 256, 256)
        label = self.img_labels.iloc[idx]['class']
        if self.transform:
            image = self.transform(image)
        if self.target_transform:
                label = self.target_transform(label)
        return image, label

ds = CTFDataset(
    annotation_file = '/kaggle/input/apoorvctf/final_y.csv',
    img_dir = '/kaggle/input/apoorvctf/train',
)

train_dataloader = DataLoader(ds, batch_size=4, shuffle=False)

class PokemonCNN(nn.Module):
    def __init__(self):
        super().__init__()

        self.conv1 = nn.Conv2d(4, 32, kernel_size=2)
        self.bn1 = nn.BatchNorm2d(32)
        self.relu = nn.ReLU()
        self.pool = nn.MaxPool2d(kernel_size=3)
        self.drop1 = nn.Dropout(0.25)

        self.conv2 = nn.Conv2d(32, 64, kernel_size=2)
        self.bn2 = nn.BatchNorm2d(64)
        self.relu2 = nn.ReLU()
        self.pool2 = nn.MaxPool2d(kernel_size=3)
        self.drop2 = nn.Dropout(0.25)

        self.conv3 = nn.Conv2d(64, 128, kernel_size=2)
        self.bn3 = nn.BatchNorm2d(128)
        self.relu3 = nn.ReLU()
        self.pool3 = nn.MaxPool2d(kernel_size=3)
        self.drop3 = nn.Dropout(0.25)

        self.flatten = nn.Flatten()
        self.fc1 = nn.Linear(10368, 512)
        self.bn4 = nn.BatchNorm1d(512)
        self.drop4 = nn.Dropout(0.5)
        self.fc2 = nn.Linear(512, 18)
        self.softmax = nn.Softmax()

    def forward(self, x):
        x = self.pool(F.relu(self.bn1(self.conv1(x))))
        x = self.drop1(x)

        x = self.pool(F.relu(self.bn2(self.conv2(x))))
        x = self.drop2(x)

        x = self.pool(F.relu(self.bn3(self.conv3(x))))
        x = self.drop3(x)

        x = self.flatten(x)
        x = self.fc1(x)
        x = self.bn4(x)
        x = self.drop4(x)
        x = self.fc2(x)
        x = self.softmax(x)
        return x

sum(dict(pk.named_parameters())["fc1.weight"][0]) = tensor(-3.6320, grad_fn=<AddBackward0>)
dict(pk.named_parameters())["fc2.weight"][2][15] = tensor(-0.0241, grad_fn=<SelectBackward0>)

# apoorvctf{P1k4chu_0ch0t0n4_pr1nc3ps}
```

# ghctf2025

Ê≤°ÊÉ≥Âà∞ÂõΩÂÜÖ‰πüÊúâÊØîËµõÂçïÂºÄ‰∫Ü‰∏Ä‰∏™ËµõÈÅì, ÊúâÊó∂Èó¥ËØïÁùÄË∑üwpÂ≠¶‰π†Â≠¶‰π†.

## mortis



# ÂèÇËÄÉÊñáÁåÆ


[^3b1b]: 3Blue1Brown.„ÄêÂÆòÊñπÂèåËØ≠„ÄëÊ∑±Â∫¶Â≠¶‰π†‰πãÁ•ûÁªèÁΩëÁªúÁöÑÁªìÊûÑ Part 1 ver 2.0[EB/OL].bilibili.<a target="_blank" href='https://www.bilibili.com/video/BV1bx411M7Zx'>https://www.bilibili.com/video/BV1bx411M7Zx</a>.2017-10-19
[^numpy2cnn]: qxcheng.Áî®numpyÂÆûÁé∞CNNÂç∑ÁßØÁ•ûÁªèÁΩëÁªú[EB/OL].ÂçöÂÆ¢Âõ≠.<a target="_blank" href='https://www.cnblogs.com/qxcheng/p/11729773.html'>https://www.cnblogs.com/qxcheng/p/11729773.html</a>.2019-10-23



