---
title: '[AIå­¦ä¹ ç¬”è®°] ç®€å•çš„AIç±»é¢˜ç›®æ±‡æ€».'
date: 2025-03-10
permalink: /posts/2025/03/ctf_ai/
excerpt: 'ä¸çŸ¥é“æ˜¯ä¸æ˜¯å› ä¸ºå¼€å§‹å…³æ³¨èµ·AI, æœ€è¿‘æ„Ÿè§‰AIç±»é¢˜å‹è¶Šæ¥è¶Šå¤šäº†...'
tags:
  - ç½‘ç»œå®‰å…¨
  - CTF
  - AI
---

# ç›®å½•

- [å‰ç½®æ¦‚å¿µ](#å‰ç½®æ¦‚å¿µ)
  - [cnn](#cnn)
- [apoorvctf2025](#apoorvctf2025)
  - [professor_oak's_electric_misfortune](#professor_oak's_electric_misfortune)
- [ghctf2025](#ghctf2025)
  - [mortis](#mortis)
- [å‚è€ƒæ–‡çŒ®](#å‚è€ƒæ–‡çŒ®)

# å‰ç½®æ¦‚å¿µ

å…¶å®æˆ‘æœ¬æ„æ˜¯ä¸å¤ªæƒ³è®°å½•AIç±»é¢˜ç›®æ¥ç€, æˆ‘ç”¨äºè®­ç»ƒAIçš„ç”µè„‘è¢«å•ç‹¬éš”ç¦»å¼€, ä¸æ‰“æ¯”èµ›çš„ç”µè„‘åˆ†åˆ«å•ç‹¬å­˜æ”¾, ä½†æ˜¯å­¦ç€å†™ä¸€ç‚¹ä¸œè¥¿æ€»æ˜¯å¥½çš„, ä¸‡ä¸€ä»¥åéœ€è¦äº†å‘¢(ç¬‘).

## cnn

CNNåˆç§°å·ç§¯ç¥ç»ç½‘ç»œ, ç®—æ˜¯å¤§éƒ¨åˆ†å…¥é—¨AIçš„ç¬¬ä¸€è¯¾, æˆ‘è®°å¾—å½“æ—¶æ˜¯çœ‹äº†3b1bçš„è§†é¢‘[^3b1b], äº†è§£äº†ä¸ªå¤§æ¦‚åè‡ªå·±æŒ‰ç…§ä¸€äº›ç›¸å…³åšå®¢è¯•ç€ç”¨numpyæ­å»ºäº†ä¸€ä¸ªç®€å•çš„æ¨¡å‹[^numpy2cnn], å¯æƒœè¯†åˆ«æ•ˆç‡å¤ªä½, å°±ä¸åˆ†äº«äº†. 3b1bçš„å¯è§†åŒ–åšå¾—å¾ˆå¥½, å°±ä¸è¿‡å¤šèµ˜è¿°äº†.

å¦‚æœå·ç§¯çš„å˜é‡æ˜¯åºåˆ—$$x(n)$$å’Œ$$h(n)$$ï¼Œåˆ™å·ç§¯çš„ç»“æœä¸º:

$$
x(n) * h(n) = \sum{x(i)h(n-i)}
$$

å·ç§¯ç¥ç»ç½‘ç»œä½¿ç”¨äº†å·ç§¯è¿ç®—, ç”¨äºæ•æ‰å›¾åƒä¸­çš„å±€éƒ¨ç‰¹å¾.

# apoorvctf2025

## professor_oak's_electric_misfortune

å®é™…ä¸Šåœ¨æ¯”èµ›åˆšå¼€å§‹çš„æ—¶å€™æˆ‘åªçœ‹äº†è¿™ä¸€é¢˜, æè¿°å¦‚ä¸‹:

> ğŸ”¥ Welcome, PokÃ©mon Trainer! ğŸ”¥ Hello there! Welcome to the world of PokÃ©mon! ğŸŒâš¡ Iâ€™m Professor Oak, the leading PokÃ©mon researcher, and Iâ€™ve been working on an advanced PokÃ©dex upgrade that can automatically classify PokÃ©mon types using cutting-edge neural networks. This breakthrough could revolutionize how trainers understand their PokÃ©mon! BUTâ€¦ thereâ€™s been a slight hiccup in the lab. ğŸ˜° My Pikachu got a little too excited andâ€”well, letâ€™s just say a few crucial data files were shocked into oblivion. âš¡ğŸ’¥ Now, the entire system is scrambled, and I need your help to restore order and complete the classifier! Now.. For further details, access the PDF. Heads up!! It's password protected. The password is the name of the pokemon Ash first captured. Good Luck Trainer !!!

### é¢˜ç›®

```
UG9rZW1vbkNOTgrilJzilIDilIAgSW5pdGlhbCBJbnB1dDogKDI1NiwgMjU2LCA0KQrilIIK4pSc4pSA4pSAIEZlYXR1cmUgRXh0cmFjdGlvbiBMYXllcnMK4pSCICAg4pSc4pSA4pSAIENvbnYyRCAoNC0+MzIpCuKUgiAgIOKUnOKUgOKUgCBCYXRjaE5vcm0yRCAK4pSCICAg4pSc4pSA4pSAIFJlTFUgQWN0aXZhdGlvbgrilIIgICDilJzilIDilIAgTWF4UG9vbDJEKEsgU2l6ZSA9IDMpCuKUgiAgIOKUnOKUgOKUgCBEcm9wb3V0IChwPTAuMjUpCuKUggrilJzilIDilIAgRGVlcGVyIFByb2Nlc3NpbmcK4pSCICAg4pSc4pSA4pSAIENvbnYyRCgzMi0+NjQpCuKUgiAgIOKUnOKUgOKUgCBCYXRjaE5vcm0yRCAoNjQpCuKUgiAgIOKUnOKUgOKUgCBSZUxVIEFjdGl2YXRpb24K4pSCICAg4pSc4pSA4pSAIE1heFBvb2wyRChLIFNpemUgPSAzKQrilIIgICDilJzilIDilIAgRHJvcG91dCAocD0wLjI1KQrilIIK4pSc4pSA4pSAIE1vcmUgRmVhdHVyZSBFeHRyYWN0aW9uCuKUgiAgIOKUnOKUgOKUgCBDb252MkQoNjQtPjEyOCkK4pSCICAg4pSc4pSA4pSAIEJhdGNoTm9ybTJECuKUgiAgIOKUnOKUgOKUgCBSZUxVIEFjdGl2YXRpb24K4pSCICAg4pSc4pSA4pSAIE1heFBvb2wyRChLIFNpemUgPSAzKQrilIIgICDilJzilIDilIAgRHJvcG91dCAocD0wLjI1KQrilIIK4pSc4pSA4pSAIEZ1bGx5IENvbm5lY3RlZCBMYXllcnMK4pSCICAg4pSc4pSA4pSAIEZsYXR0ZW4K4pSCICAg4pSc4pSA4pSAIExpbmVhciAoNTEyIE5ldXJvbnMpCuKUgiAgIOKUnOKUgOKUgCBCYXRjaE5vcm0xRArilIIgICDilJzilIDilIAgRHJvcG91dCAocD0wLjUpCuKUgiAgIOKUnOKUgOKUgCBMaW5lYXIK4pSCICAg4pSc4pSA4pSAIFNvZnRtYXggQWN0aXZhdGlvbgrilIIK4pSU4pSA4pSAIE91dHB1dDogMTggY2xhc3Nlcw==
```

å¦å¤–è¿˜æœ‰ä¸€ä¸ªpdfæ–‡ä»¶, å¯†ç ä¸º`caterpie`, ç‚¹å¼€åæœ‰å¦‚ä¸‹å†…å®¹:

>Welcome, PokÃ©mon Trainer! 
> 
>Hello there! Welcome to the world of PokÃ©mon! 
> 
>Iâ€™m Professor Oak, the leading PokÃ©mon researcher, and Iâ€™ve been working on an advanced PokÃ©dex upgrade that can automatically classify PokÃ©mon types using cutting-edge neural networks. This breakthrough could revolutionize how trainers understand their PokÃ©mon! 
>
>BUTâ€¦ thereâ€™s been a slight hiccup in the lab. 
> 
>My Pikachu got a little too excited andâ€”well, letâ€™s just say a few crucial data files were shocked into oblivion. Now, the entire system is scrambled, and I need your help to restore order and complete the classifier! 
>
>Your mission: Train a CNN model to classify PokÃ©mon by type and help me get the PokÃ©dex back on track. Are you up for the challenge, Trainer? Letâ€™s GO! 
>
>Notebook link: https://www.kaggle.com/code/gl3mon/apoorvquestion 
>Dataset link: https://www.kaggle.com/datasets/gl3mon/apoorvctf

### åˆ†æ

å¾ˆé—æ†¾å½“æˆ‘å¾—çŸ¥å¯†ç æ˜¯ç»¿æ¯›è™«çš„æ—¶å€™å·²ç»æ‰¾ä¸åˆ°é¡µé¢äº†, æ‰€ä»¥ç›´æ¥ç®€å•å¤ç›˜ä¸€ä¸‹ä»£ç éƒ¨åˆ†, æ ¸å¿ƒæºç å¦‚ä¸‹:

```python
class PokemonCNN(nn.Module):
    def __init__(self):
        super().__init__()

        self.conv1 = nn.Conv2d(4, 32, kernel_size=2)
        self.bn1 = nn.BatchNorm2d(32)
        self.relu = nn.ReLU()
        self.pool = nn.MaxPool2d(kernel_size=3)
        self.drop1 = nn.Dropout(0.25)

        self.conv2 = nn.Conv2d(32, 64, kernel_size=2)
        self.bn2 = nn.BatchNorm2d(64)
        self.relu2 = nn.ReLU()
        self.pool2 = nn.MaxPool2d(kernel_size=3)
        self.drop2 = nn.Dropout(0.25)

        self.conv3 = nn.Conv2d(64, 128, kernel_size=2)
        self.bn3 = nn.BatchNorm2d(128)
        self.relu3 = nn.ReLU()
        self.pool3 = nn.MaxPool2d(kernel_size=3)
        self.drop3 = nn.Dropout(0.25)

        self.flatten = nn.Flatten()
        self.fc1 = nn.Linear(10368, 512)
        self.bn4 = nn.BatchNorm1d(512)
        self.drop4 = nn.Dropout(0.5)
        self.fc2 = nn.Linear(512, 18)
        self.softmax = nn.Softmax()

    def forward(self, x):
        x = self.pool(F.relu(self.bn1(self.conv1(x))))
        x = self.drop1(x)

        x = self.pool(F.relu(self.bn2(self.conv2(x))))
        x = self.drop2(x)

        x = self.pool(F.relu(self.bn3(self.conv3(x))))
        x = self.drop3(x)

        x = self.flatten(x)
        x = self.fc1(x)
        x = self.bn4(x)
        x = self.drop4(x)
        x = self.fc2(x)
        x = self.softmax(x)
        return x
```

emmmm, é¢˜ç›®å¥½åƒæœ‰ç‚¹å¤æ‚äº†, æ®æè¿°éœ€è¦ä½¿ç”¨**GPU T4x2**, ä¸è¿‡ç»“åˆä¹‹å‰å­¦ä¹ deepseekçš„ä¸€äº›ç»éªŒ, ç†è®ºä¸Šæ˜¯å¯ä»¥åŠ å…¥ä»¥ä¸‹ä»£ç ä¿®æ”¹çš„:

```python
def __init__(self):
        self.device = "cuda" if pt.cuda.is_available() else "cpu"
        print(f"Using device: {self.device}")
```

ç„¶åå…ˆè¿›ç¬¬ä¸€é¢˜:

> Question 1: What is the seed of the given code?

ç¨‹åºä¸­ç»™å‡ºäº†æç¤º: `I have not mentioned the seed for security reasons. But I'll let you in on a little secret. It's the pokemon number for charizard.`, ä½†æ˜¯ç†è§£ä¸äº†, å¤ç›˜çš„æ—¶å€™æˆ‘ç›´æ¥ä¸Šäº†çˆ†ç ´:

```python
from EXP.pwn import *

def test(num):
    io("./test")
    print(r())
    s(str(num).encode())
    data = bool(r() == b'> Incorrect answer for question 1.\n')
    close()
    return data

for i in range(10000):
    if test(i):
        continue
    else:
        print(i)
        break

# [*] Stopped process './test' (pid 613)
# 151
```

ä¸æ˜¯å¾ˆç†è§£å–·ç«é¾™ä¸ºä»€ä¹ˆæ˜¯151æ€»ä¹‹, ä½†æ˜¯æ‹¿åˆ°äº†ç§å­ç¼–å·, å¯ä»¥ç›´æ¥ä¿®æ”¹ä¸º`pt.manual_seed(151)`.

> Question 2: Whatâ€™s the number of input features of the first linear layer?

è·‘ä¸å‡ºæ¥, ç›´æ¥æ”¾ä»£ç , æœ‰æ—¶é—´å†æ…¢æ…¢è¯´.

### EXP

```python
import torch as pt
import torch.nn.functional as F
import torch.nn as nn

pt.manual_seed(151) # I have not mentioned the seed for security reasons. But I'll let you in on a little secret. It's the pokemon number for charizard.

from torch.utils.data import Dataset, DataLoader
from torchvision import datasets
from torchvision.transforms import ToTensor
import matplotlib.pyplot as plt

import os
import pandas as pd
from torchvision.io import read_image

class CTFDataset(Dataset):
    def __init__(self, annotation_file, img_dir, transform = None, target_transform = None):
        self.img_labels = pd.read_csv(annotation_file, index_col=0)
        self.label_mapping = {
            'Bug': 0, 'Dark': 1, 'Dragon': 2, 'Electric': 3, 'Fairy': 4,
            'Fighting': 5, 'Fire': 6, 'Flying': 7, 'Ghost': 8, 'Grass': 9,
            'Ground': 10, 'Ice': 11, 'Normal': 12, 'Poison': 13, 'Psychic': 14,
            'Rock': 15, 'Steel': 16, 'Water': 17
        }
        self.img_labels['class'] = self.img_labels['type'].map(self.label_mapping)
        self.img_dir = img_dir
        self.transform = transform
        self.target_transform = target_transform

    def __len__(self):
        return len(self.img_labels)

    def __getitem__(self, idx):
        img_path = os.path.join(self.img_dir, self.img_labels.iloc[idx]['type'], f'{self.img_labels.iloc[idx]["pkn"]}'+'.png')
        image = None
        try:
            image = read_image(img_path).to(pt.float32)
        except:
            image = pt.zeros(4, 256, 256)
        label = self.img_labels.iloc[idx]['class']
        if self.transform:
            image = self.transform(image)
        if self.target_transform:
                label = self.target_transform(label)
        return image, label

ds = CTFDataset(
    annotation_file = '/kaggle/input/apoorvctf/final_y.csv',
    img_dir = '/kaggle/input/apoorvctf/train',
)

train_dataloader = DataLoader(ds, batch_size=4, shuffle=False)

class PokemonCNN(nn.Module):
    def __init__(self):
        super().__init__()

        self.conv1 = nn.Conv2d(4, 32, kernel_size=2)
        self.bn1 = nn.BatchNorm2d(32)
        self.relu = nn.ReLU()
        self.pool = nn.MaxPool2d(kernel_size=3)
        self.drop1 = nn.Dropout(0.25)

        self.conv2 = nn.Conv2d(32, 64, kernel_size=2)
        self.bn2 = nn.BatchNorm2d(64)
        self.relu2 = nn.ReLU()
        self.pool2 = nn.MaxPool2d(kernel_size=3)
        self.drop2 = nn.Dropout(0.25)

        self.conv3 = nn.Conv2d(64, 128, kernel_size=2)
        self.bn3 = nn.BatchNorm2d(128)
        self.relu3 = nn.ReLU()
        self.pool3 = nn.MaxPool2d(kernel_size=3)
        self.drop3 = nn.Dropout(0.25)

        self.flatten = nn.Flatten()
        self.fc1 = nn.Linear(10368, 512)
        self.bn4 = nn.BatchNorm1d(512)
        self.drop4 = nn.Dropout(0.5)
        self.fc2 = nn.Linear(512, 18)
        self.softmax = nn.Softmax()

    def forward(self, x):
        x = self.pool(F.relu(self.bn1(self.conv1(x))))
        x = self.drop1(x)

        x = self.pool(F.relu(self.bn2(self.conv2(x))))
        x = self.drop2(x)

        x = self.pool(F.relu(self.bn3(self.conv3(x))))
        x = self.drop3(x)

        x = self.flatten(x)
        x = self.fc1(x)
        x = self.bn4(x)
        x = self.drop4(x)
        x = self.fc2(x)
        x = self.softmax(x)
        return x

sum(dict(pk.named_parameters())["fc1.weight"][0]) = tensor(-3.6320, grad_fn=<AddBackward0>)
dict(pk.named_parameters())["fc2.weight"][2][15] = tensor(-0.0241, grad_fn=<SelectBackward0>)

# apoorvctf{P1k4chu_0ch0t0n4_pr1nc3ps}
```

# ghctf2025

æ²¡æƒ³åˆ°å›½å†…ä¹Ÿæœ‰æ¯”èµ›å•å¼€äº†ä¸€ä¸ªèµ›é“, æœ‰æ—¶é—´è¯•ç€è·Ÿwpå­¦ä¹ å­¦ä¹ .

## mortis



# å‚è€ƒæ–‡çŒ®


[^3b1b]: 3Blue1Brown.ã€å®˜æ–¹åŒè¯­ã€‘æ·±åº¦å­¦ä¹ ä¹‹ç¥ç»ç½‘ç»œçš„ç»“æ„ Part 1 ver 2.0[EB/OL].bilibili.<a target="_blank" href='https://www.bilibili.com/video/BV1bx411M7Zx'>https://www.bilibili.com/video/BV1bx411M7Zx</a>.2017-10-19
[^numpy2cnn]: qxcheng.ç”¨numpyå®ç°CNNå·ç§¯ç¥ç»ç½‘ç»œ[EB/OL].åšå®¢å›­.<a target="_blank" href='https://www.cnblogs.com/qxcheng/p/11729773.html'>https://www.cnblogs.com/qxcheng/p/11729773.html</a>.2019-10-23



